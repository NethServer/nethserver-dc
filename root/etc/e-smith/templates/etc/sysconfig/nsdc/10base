# bind the container to this bridge device
{
    use esmith::NetworksDB;
    use Net::IPv4Addr qw( :all );
    my $ndb = esmith::NetworksDB->open_ro();
    my $bridge;
    my $nsdcIp = $nsdc{IpAddress} or die ("[ERROR] NethServer domain controller address not configured!");

    #find a "green" bridge wich network contains NethServer domain controller IP address and use it as bridge for Samba 4 DC machine
    foreach ($ndb->green()) {
        my $type = $_->prop('type') || 'ethernet';
        if ($type eq 'bridge' && ipv4_in_network($_->prop('ipaddr'), $_->prop('netmask'), $nsdcIp, '255.255.255.255')) {
            $bridge = $_->key;
            last;
        }
    }
    if ($bridge) {
        $OUT .= "BRIDGE=$bridge\n";
    } else {
        die ("[ERROR] There is no network bridge for NethServer domain controller");
    }
}
